#? stdtmpl | standard
#
#template `%`(idx: untyped): untyped =
#  row[idx]
#end template
#
#
#
#
#
#proc genNavbarLoggedinSettings(c: var TData): string =
# result = ""
<div id="navbarSettings" class="container-fluid">
  <div style="display: inline-flex; float: right;">
    <span class="nav-item"><a href="/settings">Settings</a></span>
    <span class="nav-item" style="margin: 0 15px;"><a href="/logout">Logout</a></span>
  </div>
</div>
#end proc
#
#
#
#
#
#proc genNavbarLoggedin(c: var TData): string =
# result = ""
<div id="navbarSettings" class="container-fluid">
  <div style="display: inline-flex; float: right;">
    <span class="nav-item"><a href="/users/profile">${c.username}</a></span>
    <span class="nav-item" style="margin: 0 15px;"><a href="/logout">Logout</a></span>
  </div>
</div>
#end proc
#
#
#
#
#proc genEditMixed(newPage = true): string =
# result = ""
# if not newPage:
<div id="save" data-ischanged="0" style="display: none;"></div>
# end if
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.39.2/codemirror.min.css" integrity="sha256-I8NyGs4wjbMuBSUE40o55W6k6P7tu/7G28/JGUUYCIs=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.39.2/theme/monokai.min.css" integrity="sha256-jAukb65gp2gG6t4FtxpHgB3eFwM/rDUwrE2OaAp6+o8=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.39.2/codemirror.min.js" integrity="sha256-uRIJ6Wfou5cTtmcCvQNA9lvsYl8sUbZXxnfG+P79ssY=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.39.2/mode/xml/xml.min.js" integrity="sha256-QmQ8vh5c1+UzpnyWXYB7nnY1aqpJmXPVkFWtJHJkLnE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.39.2/mode/javascript/javascript.min.js" integrity="sha256-soPk2bgFhLwixxuyUzaWVadUMcVwWNE5JZwYdQhL4Xk=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.39.2/mode/css/css.min.js" integrity="sha256-YVb7n24DLwrjN0DghcwJYL17MI/X7e3c4EJZr6PwNdY=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.39.2/mode/htmlmixed/htmlmixed.min.js" integrity="sha256-CcVYnZJocbbLCyjOo/tA2QEH56hhTBEPZX+che0RYSo=" crossorigin="anonymous"></script>

<script src="/js/codemirror_custom.js" defer></script>

<script src="/js/editors.js" defer></script>

#end proc
#
#
#
#
#proc genEditHtml(): string =
# result = ""
<div id="save" data-ischanged="0" style="display: none;"></div>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.37.0/codemirror.css" integrity="sha256-o/v/5fOniPHMAww4EAIfRBFV0SeoqksPrY0Yq5x+wSM=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.37.0/theme/monokai.min.css" integrity="sha256-6ov3WWd9ybfZPeJBlXBgQuD/aLhTRCEp5kBhqD9ke0o=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.37.0/codemirror.min.js" integrity="sha256-U/4XQwZXDFDdAHjIZt1Lm7sFfmMiFDZzFYprq6XJ0gk=" crossorigin="anonymous" ></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.37.0/mode/xml/xml.min.js" integrity="sha256-QmQ8vh5c1+UzpnyWXYB7nnY1aqpJmXPVkFWtJHJkLnE=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.37.0/mode/htmlmixed/htmlmixed.min.js" integrity="sha256-CcVYnZJocbbLCyjOo/tA2QEH56hhTBEPZX+che0RYSo=" crossorigin="anonymous"></script>

<script src="/js/codemirror_custom.js" defer></script>

<script src="/js/editors.js" defer></script>

#end proc
#
#
#
#
#proc genEditJs(): string =
# result = ""
<div id="save" data-ischanged="0" style="display: none;"></div>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.37.0/codemirror.css" integrity="sha256-o/v/5fOniPHMAww4EAIfRBFV0SeoqksPrY0Yq5x+wSM=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.37.0/theme/monokai.min.css" integrity="sha256-6ov3WWd9ybfZPeJBlXBgQuD/aLhTRCEp5kBhqD9ke0o=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.37.0/codemirror.min.js" integrity="sha256-U/4XQwZXDFDdAHjIZt1Lm7sFfmMiFDZzFYprq6XJ0gk=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.37.0/mode/javascript/javascript.min.js" integrity="sha256-MyRbKGolllWYWwxW8jH3jYdhK0p0LpgNjR8PqCa/UNQ=" crossorigin="anonymous"></script>

<script src="/js/codemirror_custom.js" defer></script>

<script src="/js/editors.js" defer></script>

# end proc
#
#
#
#
#proc genEditCss(): string =
# result = ""
<div id="save" data-ischanged="0" style="display: none;"></div>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.37.0/codemirror.css" integrity="sha256-o/v/5fOniPHMAww4EAIfRBFV0SeoqksPrY0Yq5x+wSM=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.37.0/theme/monokai.min.css" integrity="sha256-6ov3WWd9ybfZPeJBlXBgQuD/aLhTRCEp5kBhqD9ke0o=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.37.0/codemirror.min.js" integrity="sha256-U/4XQwZXDFDdAHjIZt1Lm7sFfmMiFDZzFYprq6XJ0gk=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.37.0/mode/css/css.min.js" integrity="sha256-YVb7n24DLwrjN0DghcwJYL17MI/X7e3c4EJZr6PwNdY=" crossorigin="anonymous"></script>

<script src="/js/codemirror_custom.js" defer></script>

<script src="/js/editors.js" defer></script>

#end proc
#
#
#
#
#proc genProfileJsCss(): string =
# result = ""
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropper/3.1.4/cropper.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropper/3.1.4/cropper.min.js" defer></script>
#end proc
#
#
#
#
#proc genPageOptions(c: var TData, page, blog, edit: bool, pageid, stdHead, stdNav, stdFoot: string): string =
# result = ""
#
# var title = ""
# var metadescription = ""
# var metakeywords = ""
# var category = ""
# var tags = ""
# var pubDate = currentDatetime("date")
# var viewCount = "0"
#
# if edit and blog:
#   let pageOrBlog = if page == true: "pages" else: "blog"
#   let details = getRow(db, sql("SELECT title, metadescription, metakeywords, category, tags, pubDate, creation, viewCount FROM " & pageOrBlog & " WHERE id = ?"), pageid)
#
#   title = details[0]
#   metadescription = details[1]
#   metakeywords = details[2]
#   category = details[3]
#   tags = details[4]
#   pubDate = if details[5] != "": details[5] else: epochDate(details[6], "YYYY-MM-DD")
#   viewCount = details[7]
# end if
#
# if edit and page:
#   let pageOrBlog = if page == true: "pages" else: "blog"
#   let details = getRow(db, sql("SELECT title, metadescription, metakeywords, category, tags FROM " & pageOrBlog & " WHERE id = ?"), pageid)
#
#   title = details[0]
#   metadescription = details[1]
#   metakeywords = details[2]
#   category = details[3]
#   tags = details[4]
# end if
#
# if edit:
<h4 class="has-text-centered">Change editor</h4>
<div class="buttons has-addons columns">
  <div class="column">
    <button class="btn btn-primary switchEditorRawHTML button is-small is-fullwidth is-info">Switch to raw HTML</button>
  </div>
  <div class="column">
    <button class="btn btn-primary switchEditorSummernote button is-small is-fullwidth is-info">Switch to Summernote</button>
  </div>
  <div class="column">
    <button class="btn btn-primary switchEditorGrapesJS button is-small is-fullwidth is-info">Switch to GrapesJS</button>
  </div>
</div>
<hr>
# end if

# if blog:
<h4 class="has-text-centered">Customize blog</h4>
<div>

  <div class="field">
    <div class="control">
      <label class="label">Publication date (visible on the blog overview)</label>
      <input class="input" type="text" name="pubdate" value="${pubDate}" dir="auto">
      <i class="is-size-7">If no date is specified, the creation date will be used. The date has no effect and will only be shown on the blog overview page. Format the date: YYYY-MM-DD</i>
    </div>
  </div>

  <div class="field">
    <div class="control">
      <label class="label">View counter starting at</label>
      <input class="input" type="number" name="viewcount" value="${viewCount}" dir="auto">
    </div>
  </div>

</div>

<hr>
# end if

<h4 class="has-text-centered">Categorize</h4>
<div>

  <div class="field">
    <div class="control">
      <label class="label">Category</label>
      <input class="input" type="text" name="category" value="${category}" placeholder="Single word category" dir="auto">
    </div>
  </div>

  <div class="field">
    <div class="control">
      <label class="label">Tags</label>
      <input class="input" type="text" name="tags" value="${tags}" placeholder="Comma separated tags, e.g. nim,macro" dir="auto">
    </div>
  </div>

</div>

<hr>

<h4 class="has-text-centered">HTML</h4>
<div style="margin-bottom: 20px;">

  <div class="notification is-warning">
    If you disable standard default components (CSS/JS),
    you have to include Style and JavaScript tags by yourself.
  </div>

  <div class="input-group input-group-sm">

    <div class="field">
      <div class="control">
        <input class="checkbox" type="checkbox" id="standardhead" name="standardhead" ${checkboxToChecked($stdHead)}>
          Use standard head &lt;head&gt;
        </input>
      </div>
    </div>

    <div class="field">
      <div class="control">
        <input class="checkbox" type="checkbox" id="standardnavbar" name="standardnavbar" ${checkboxToChecked($stdNav)}>
          Use standard navbar &lt;navbar&gt;
        </input>
      </div>
    </div>

    <div class="field">
      <div class="control">
        <input class="checkbox" type="checkbox" id="standardfooter" name="standardfooter" ${checkboxToChecked($stdFoot)}>
          Use standard footer &lt;footer&gt;
        </input>
      </div>
    </div>

  </div>
</div>

<hr>

<h4 class="has-text-centered">SEO</h4>
<div class="notification is-warning">
  HTML is not allowed, only plain text (ASCII).
</div>
<div>

  <div class="field">
    <div class="control">
      <label class="label">Title</label>
      <input class="input" type="text" name="title" value="${title}" dir="auto">
    </div>
  </div>

  <div class="field">
    <div class="control">
      <label class="label">Meta description</label>
      <textarea class="textarea" name="metadescription" placeholder="Type or paste your Meta description here..." dir="auto">${metadescription}</textarea>
    </div>
  </div>

  <div class="field">
    <div class="control">
      <label class="label">Meta keywords</label>
      <textarea class="textarea" name="metakeywords" placeholder="Separate each keywords with a comma, e.g. blog,design,code" dir="auto">${metakeywords}</textarea>
    </div>
  </div>

</div>

# if edit:
<hr>
<h4 class="has-text-centered">Delete page</h4>
<div class="notification is-danger">
  If you Delete a page it can not be undone.
</div>
<div class="buttons" style="margin-bottom: 20px;">
  # if page:
    <span data-url="/page/delete?pageid=$pageid" class="btn btn-danger pageDelete button is-danger" title="If you delete a page it can not be undone">Delete page</span>
  # else:
    <span data-url="/blogpage/delete?blogid=$pageid" class="btn btn-danger blogDelete button is-danger" title="If you delete a blogpost it can not be undone">Delete blogpost</span>
  # end if
</div>
# end if
#
#end proc
#
#
#
#
#proc genPageEditorMainNew(c: var TData, classBlogPage: string): string =
# result = ""
#
# if c.req.cookies.hasKey("editor") and c.req.cookies["editor"] == "grape":
  <div id="gjs" class="gls">
    <div id="mainContainer" class="${classBlogPage}">
      <h1>Title</h1>
      <p>The first paragraph</p>
      <hr/>
      <p>The second paragraph</p>
    </div>
    <style>
      body.gjs-dashed {
        background: transparent;
      }
    </style>
  </div>
  <textarea id="gjshidden" name="editordata" style="display: none"></textarea>
# elif c.req.cookies.hasKey("editor") and c.req.cookies["editor"] == "summernote":
  <textarea id="summernoteHidden" name="editordata" style="display: none;"></textarea>

  <div id="summernote" class="summernote">
    <div id="mainContainer" class="${classBlogPage}">
      <h1>Title</h1>
      <p>The first paragraph</p>
      <hr/>
      <p>The second paragraph</p>
    </div>
  </div>
# else:
  <textarea name="editordata" id="editordataCodemirror">
    <div id="mainContainer" class="${classBlogPage}">
      <h1>Title</h1>
      <p>The first paragraph</p>
      <hr/>
      <p>The second paragraph</p>
    </div>
  </textarea>
# end if
#end proc
#
#
#
#
#proc genPageEditorMainEdit(c: var TData, content: string): string =
# result = ""
#
# if c.req.cookies.hasKey("editor") and c.req.cookies["editor"] == "grape":
#
  <div id="gjs" class="gls">${content}</div>
  <textarea id="gjshidden" name="editordata" style="display: none"></textarea>
#
# elif c.req.cookies.hasKey("editor") and c.req.cookies["editor"] == "summernote":
#
  <div id="summernoteContainer">
    <textarea id="summernoteHidden" name="editordata" style="display: none;"></textarea>
    <div id="summernote" class="summernote">
      ${content}
    </div>
  </div>
#
# else:
#
  <textarea name="editordata" id="editordataCodemirror" class="textarea">${content}</textarea>
#
# end if
#
#end proc
#
#
#
#
#proc genPageEditorImport(c: var TData, isNewPage: bool): string =
# result = ""
# if c.req.cookies.hasKey("editor") and c.req.cookies["editor"] == "grape":
#
  <script src="https://unpkg.com/grapesjs" defer></script>
  <script src="/js/grapesjsbs4.min.js" defer></script>
  <script src="/js/grapesjs_custom.js" defer></script>
  <script src="/js/editors.js" defer></script>
  <link rel="stylesheet" href="https://unpkg.com/grapesjs/dist/css/grapes.min.css" />
  <script>
  function grapeJsLoadAssets() {
    const am = editor.AssetManager;
    am.add([

  # var multiple = false
  # for file in walkFiles("public/images/*"):
  #   if multiple:
        ,{src: '${replace(file, "public", "")}'}
  #   else:
        {src: '${replace(file, "public", "")}'}
  #     multiple = true
  #   end if
  # end for

    ]);
    am.render();
  }
  </script>
#
# elif c.req.cookies.hasKey("editor") and c.req.cookies["editor"] == "summernote":
#
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.11/summernote-bs4.css" integrity="sha256-ADCoAb8+4Q0aUjknVls52/iuqleXITKP65owZtLSGBI=" crossorigin="anonymous" />

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous" defer></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.11/summernote-bs4.min.js" integrity="sha256-EqzdHRQ0S25bXoh1W7841pzdUUgmlUk90Ov1Ckj1nk4=" crossorigin="anonymous" defer></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/themes/prism.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/prism.min.js" defer></script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/line-numbers/prism-line-numbers.min.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/plugins/line-numbers/prism-line-numbers.min.js" defer></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-nim.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-css.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-javascript.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-python.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.15.0/components/prism-bash.min.js" defer></script>
<script src="/js/editors.js" defer></script>
#
# else:
#
  ${genEditMixed(isNewPage)}
#
# end if
#end proc
